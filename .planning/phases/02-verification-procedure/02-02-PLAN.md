---
phase: 02-verification-procedure
plan: 02
type: execute
wave: 2
depends_on: ["02-01"]
files_modified:
  - public/ERC8004-SKILL.md
autonomous: true
requirements: [VFY-03, VFY-04, VFY-05, VFY-06, VFY-09]

must_haves:
  truths:
    - "An agent can construct the complete data field for getAgentWallet(uint256) using selector 0x00339509 and the ABI encoding pattern shown"
    - "An agent can construct the complete data field for ownerOf(uint256) using selector 0x6352211e and the ABI encoding pattern shown"
    - "Each function (getAgentWallet and ownerOf) has its own full copy-pasteable template AND worked example — not DRYed into one"
    - "The RPC endpoint table lists Arbitrum One (42161) and Arbitrum Sepolia (421614) with URLs"
    - "An agent knows where to send JSON-RPC requests for either supported chain"
  artifacts:
    - path: "public/ERC8004-SKILL.md"
      provides: "Step 3 (getAgentWallet eth_call), Step 4 (ownerOf eth_call), RPC Endpoints table"
      contains: "### Step 3"
    - path: "public/ERC8004-SKILL.md"
      provides: "getAgentWallet worked example with selector 0x00339509"
      contains: "0x00339509"
    - path: "public/ERC8004-SKILL.md"
      provides: "ownerOf worked example with selector 0x6352211e"
      contains: "0x6352211e"
    - path: "public/ERC8004-SKILL.md"
      provides: "RPC endpoint table with both chain IDs"
      contains: "421614"
  key_links:
    - from: "## Verification Procedure > ### Step 3"
      to: "## Agent Identity"
      via: "registryAddress and agentId from Step 1"
      pattern: "registryAddress.*Step 1|agentId.*Step 1"
    - from: "## Verification Procedure > ### Step 4"
      to: "## Agent Identity"
      via: "same registryAddress and agentId"
      pattern: "registryAddress|agentId"
    - from: "## Verification Procedure > ### RPC Endpoints"
      to: "## Agent Identity > ### Supported Chains"
      via: "chainId maps to RPC URL"
      pattern: "42161|421614"
---

<objective>
Write Steps 3-4 (registry eth_call specs) and the RPC Endpoints subsection into the Verification Procedure section of ERC8004-SKILL.md, completing Phase 2.

Purpose: Gives agents the remaining verification steps — reading the agent wallet and NFT owner from the on-chain registry — and a reference table for RPC endpoint selection by chain ID.

Output: public/ERC8004-SKILL.md with the complete `## Verification Procedure` section (Steps 1-4 + RPC Endpoints).
</objective>

<execution_context>
@/home/teresa/.claude/get-shit-done/workflows/execute-plan.md
@/home/teresa/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-verification-procedure/02-RESEARCH.md
@.planning/phases/02-verification-procedure/02-CONTEXT.md
@.planning/phases/02-verification-procedure/02-01-SUMMARY.md
@public/ERC8004-SKILL.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Write Step 3 (getAgentWallet eth_call) and Step 4 (ownerOf eth_call)</name>
  <files>public/ERC8004-SKILL.md</files>
  <action>
Replace the `<!-- Phase 2 continued -->` marker left by Plan 02-01 with Steps 3-4 and the RPC Endpoints subsection. Keep `## Result` and everything after it intact.

**ABI encoding rule** (state once before Step 3, or as a brief note at the top of Step 3):
- "Call data = `0x` + function selector (8 hex chars) + agentId zero-padded to 64 hex chars."
- Use the `agentId` from Step 1 (decimal integer from the full ID). Convert to hex, left-pad with zeros to 64 characters.

**### Step 3: Read Agent Wallet (eth_call)**
- One sentence: read the agent's wallet address from the registry contract.
- State the pre-computed selector: `getAgentWallet(uint256)` selector is `0x00339509`. (This is the QA-01 resolved value.)
- Template JSON body:
```json
{
  "jsonrpc": "2.0",
  "id": 2,
  "method": "eth_call",
  "params": [
    {
      "to": "<registryAddress from Step 1>",
      "data": "0x00339509<agentId zero-padded to 64 hex chars>"
    },
    "latest"
  ]
}
```
- Worked example using agentId=5 and registry `0x8004b3A873394d8B0Af8fD5D9C5D5a432` (same synthetic values as Phase 1):
```json
{
  "jsonrpc": "2.0",
  "id": 2,
  "method": "eth_call",
  "params": [
    {
      "to": "0x8004b3A873394d8B0Af8fD5D9C5D5a432",
      "data": "0x003395090000000000000000000000000000000000000000000000000000000000000005"
    },
    "latest"
  ]
}
```
- Response (synthetic):
```json
{
  "jsonrpc": "2.0",
  "id": 2,
  "result": "0x000000000000000000000000d8da6bf26964af9d7eed9e03e53415d37aa96045"
}
```
- Synthetic data disclaimer as blockquote.
- State the result: "The `result` field contains the agent wallet address. Save this for comparison in the Result step."
- Do NOT explain response decoding per user decision.

**### Step 4: Read NFT Owner (eth_call)**
- One sentence: read the NFT owner address from the registry contract.
- State the pre-computed selector: `ownerOf(uint256)` selector is `0x6352211e`.
- Full template JSON body (do NOT DRY — per locked decision, each function gets its own complete copy-pasteable example):
```json
{
  "jsonrpc": "2.0",
  "id": 3,
  "method": "eth_call",
  "params": [
    {
      "to": "<registryAddress from Step 1>",
      "data": "0x6352211e<agentId zero-padded to 64 hex chars>"
    },
    "latest"
  ]
}
```
- Worked example using same agentId=5 and registry:
```json
{
  "jsonrpc": "2.0",
  "id": 3,
  "method": "eth_call",
  "params": [
    {
      "to": "0x8004b3A873394d8B0Af8fD5D9C5D5a432",
      "data": "0x6352211e0000000000000000000000000000000000000000000000000000000000000005"
    },
    "latest"
  ]
}
```
- Response (synthetic):
```json
{
  "jsonrpc": "2.0",
  "id": 3,
  "result": "0x000000000000000000000000e41d2489571d322189246dafa5ebde1f4699f498"
}
```
- Synthetic data disclaimer as blockquote.
- State the result: "The `result` field contains the NFT owner address. Save this for comparison in the Result step."

**### RPC Endpoints**
- One sentence: select the RPC endpoint based on the `chainId` from Step 1.
- Table:

| Chain ID | Network | RPC Endpoint |
|----------|---------|-------------|
| 42161 | Arbitrum One | `https://arb1.arbitrum.io/rpc` |
| 421614 | Arbitrum Sepolia | `https://sepolia-rollup.arbitrum.io/rpc` |

- Note: this table duplicates the Supported Chains table from Agent Identity — that is intentional. Agents reading the verification procedure should not need to scroll back.

Style notes:
- Same terse imperative spec voice as Phase 1 and Plan 02-01.
- JSON bodies only. POST URL and Content-Type were stated in the procedure intro (Plan 02-01).
- No inline error handling — Phase 3 covers errors.
- No response decoding explanation per user decision.
- Use synthetic data with blockquote disclaimers per Phase 1 precedent.
  </action>
  <verify>
Read public/ERC8004-SKILL.md and confirm:
1. `### Step 3: Read Agent Wallet` exists with selector `0x00339509` in template and worked example
2. `### Step 4: Read NFT Owner` exists with selector `0x6352211e` in template and worked example
3. Both steps have FULL independent templates (not DRYed)
4. Both worked examples use agentId=5 with data field `0x00339509...0005` and `0x6352211e...0005` respectively
5. `### RPC Endpoints` table lists both 42161 and 421614
6. `<!-- Phase 2 continued -->` marker is gone
7. `## Result` heading still exists below the new content
8. No response decoding explanation appears
9. Synthetic data disclaimers present as blockquotes
10. No Phase 3 content (pass/fail, error conditions) leaked in
  </verify>
  <done>
The Verification Procedure section is complete with all four steps (extract, ecRecover, getAgentWallet, ownerOf) and an RPC Endpoints reference table. Each eth_call function has its own full template and worked example. The getAgentWallet selector is the QA-01 resolved value 0x00339509. The ownerOf selector is 0x6352211e. Both chain IDs are listed. The section stops at address collection — Phase 3 handles comparison and pass/fail logic.
  </done>
</task>

</tasks>

<verification>
- public/ERC8004-SKILL.md contains `### Step 1`, `### Step 2`, `### Step 3`, `### Step 4`, and `### RPC Endpoints` under `## Verification Procedure`
- `0x00339509` appears in Step 3 (getAgentWallet selector — QA-01 resolved)
- `0x6352211e` appears in Step 4 (ownerOf selector)
- Each function has independent template + worked example (not DRYed)
- RPC table has 42161 and 421614 with correct URLs
- `## Result` section is untouched (still `<!-- Phase 3 -->`)
- No Phase 3 content present
- No response decoding explanation
- Synthetic data disclaimers as blockquotes
</verification>

<success_criteria>
An agent reading the complete Verification Procedure section can: (1) extract five values from a signed block, (2) recover the signer address via personal_ecRecover, (3) read the agent wallet via eth_call with selector 0x00339509, (4) read the NFT owner via eth_call with selector 0x6352211e, and (5) select the correct RPC endpoint by chain ID. The section is self-contained for its scope and leaves comparison/pass-fail to Phase 3.
</success_criteria>

<output>
After completion, create `.planning/phases/02-verification-procedure/02-02-SUMMARY.md`
</output>
